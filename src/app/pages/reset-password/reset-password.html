<div class="login-bg">
  <div class="login-card">
    <div class="login-logo">
      <svg width="50" height="50" viewBox="0 0 40 40" aria-hidden="true" class="login-svg">
        <defs>
          <linearGradient id="greenGradient" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#3cb371"/>
            <stop offset="100%" stop-color="#51a2e3"/>
          </linearGradient>
        </defs>
        <circle cx="20" cy="20" r="20" fill="url(#greenGradient)" />
        <text x="50%" y="57%" text-anchor="middle" fill="#fff" font-size="1.6em" font-family="Inter, Arial, sans-serif" font-weight="bold" dy=".3em">G</text>
      </svg>
      <span class="login-brand">GreenPathAI</span>
    </div>
    <h2 class="login-title">Nouveau mot de passe</h2>
    <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" *ngIf="!success">
      <div class="login-field password-field" [class.login-error]="resetForm.get('password')?.invalid && resetForm.get('password')?.touched">
        <label for="password" class="visually-hidden">Nouveau mot de passe</label>
        <span class="fa fa-lock"></span>
        <input id="password" [type]="showPassword ? 'text' : 'password'" formControlName="password" placeholder="Nouveau mot de passe" required>
        <button type="button" class="eye-btn" (click)="togglePassword()" [attr.aria-label]="showPassword ? 'Masquer le mot de passe' : 'Afficher le mot de passe'">
          <span [ngClass]="showPassword ? 'fa fa-eye-slash' : 'fa fa-eye'"></span>
        </button>
      </div>
      <div class="login-error-message" *ngIf="resetForm.get('password')?.invalid && resetForm.get('password')?.touched">
        Le mot de passe doit faire au moins 8 caractères.
      </div>
      <div class="login-field password-field" [class.login-error]="resetForm.hasError('mismatch') && resetForm.get('confirm')?.touched">
        <label for="confirm" class="visually-hidden">Confirmer le mot de passe</label>
        <span class="fa fa-lock"></span>
        <input id="confirm" [type]="showConfirm ? 'text' : 'password'" formControlName="confirm" placeholder="Confirmer le mot de passe" required>
        <button type="button" class="eye-btn" (click)="toggleConfirm()" [attr.aria-label]="showConfirm ? 'Masquer le mot de passe' : 'Afficher le mot de passe'">
          <span [ngClass]="showConfirm ? 'fa fa-eye-slash' : 'fa fa-eye'"></span>
        </button>
      </div>
      <div class="login-error-message" *ngIf="resetForm.hasError('mismatch') && resetForm.get('confirm')?.touched">
        Les mots de passe ne correspondent pas.
      </div>
      <div class="login-error-message" *ngIf="error">{{error}}</div>
      <button class="login-btn" type="submit" [disabled]="resetForm.invalid || loading">
        {{ loading ? 'Réinitialisation...' : 'Réinitialiser' }}
      </button>
    </form>
    <div *ngIf="success" style="text-align:center;color:#3cb371;font-weight:700;">
      {{success}}<br>Redirection vers la connexion...
    </div>
    <div class="login-links">
      <a routerLink="/login">Retour connexion</a>
    </div>
  </div>
</div>
